<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <link rel="icon" type="image/png" href="/img/logo_tab.png">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:500,700,800,900&display=swap&subset=cyrillic-ext"
          rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/profile.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/c98d165499.js" crossorigin="anonymous"></script>
</head>
<body>

<nav class="navbar bg-primary navbar-expand-lg" data-bs-theme="dark">
    <div class="container-fluid w-75">
        <a class="navbar-brand" href="/user/profile">
            <img src="/img/logo_rmat_2.png" alt="" width="100">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">
            <ul class="navbar-nav align-items-center">
                <li class="nav-item">
                    <a class="nav-link text-center" href="/user/profile" style="width: 4rem">Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-center" th:href="@{/user/library/{id}(id=${user.getId()})}"
                       style="width: 5rem">Library</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-center" th:href="@{/user/history/{id}(id=${user.getId()})}"
                       style="width: 5rem">History</a>
                </li>
                <li class="align-self-center py-2 mx-2">
                    <a class="text-decoration-none" th:href="@{/user/account/{id}(id=${user.getId()})}">
                        <svg width="25" height="25" viewBox="0 0 898 898" fill="none"
                             xmlns="http://www.w3.org/2000/svg" class="m-0">
                            <path
                                    d="M898 448.551C898 200.927 696.848 0 449 0C201.152 0 0 200.927 0 448.551C0 584.935 61.962 707.848 158.946 790.352C159.844 791.25 160.742 791.25 160.742 792.148C168.824 798.434 176.906 804.72 185.886 811.006C190.376 813.7 193.968 817.236 198.458 820.828C272.659 871.137 360.25 898.02 449.898 898C539.546 898.02 627.137 871.137 701.338 820.828C705.828 818.134 709.42 814.598 713.91 811.848C721.992 805.618 730.972 799.332 739.054 793.046C739.952 792.148 740.85 792.148 740.85 791.25C836.038 707.792 898 584.935 898 448.551V448.551ZM449 841.482C364.588 841.482 287.36 814.542 223.602 769.698C224.5 762.514 226.296 755.386 228.092 748.202C233.443 728.733 241.291 710.038 251.44 692.583C261.318 675.521 272.992 660.255 287.36 646.785C300.83 633.315 316.994 620.799 333.158 610.921C350.22 601.043 368.18 593.859 387.936 588.471C407.846 583.104 428.38 580.405 449 580.445C510.213 580.011 569.176 603.492 613.334 645.887C633.988 666.541 650.152 690.787 661.826 718.568C668.112 734.732 672.602 751.794 675.296 769.698C609.022 816.291 530.013 841.354 449 841.482ZM311.606 426.157C303.694 408.041 299.715 388.452 299.932 368.685C299.932 348.985 303.524 329.229 311.606 311.269C319.688 293.309 330.464 277.201 343.934 263.731C357.404 250.261 373.568 239.542 391.528 231.46C409.488 223.378 429.244 219.785 449 219.785C469.654 219.785 488.512 223.378 506.472 231.46C524.432 239.542 540.596 250.317 554.066 263.731C567.536 277.201 578.312 293.365 586.394 311.269C594.476 329.229 598.068 348.985 598.068 368.685C598.068 389.339 594.476 408.197 586.394 426.101C578.594 443.795 567.64 459.923 554.066 473.695C540.289 487.249 524.162 498.184 506.472 505.967C469.364 521.217 427.738 521.217 390.63 505.967C372.94 498.184 356.813 487.249 343.036 473.695C329.443 460.123 318.75 443.931 311.606 426.101V426.157ZM728.278 723.956C728.278 722.16 727.38 721.262 727.38 719.466C718.548 691.371 705.53 664.768 688.766 640.555C671.986 616.162 651.364 594.649 627.702 576.853C609.631 563.258 590.043 551.807 569.332 542.729C578.754 536.513 587.485 529.306 595.374 521.233C608.762 508.016 620.52 493.243 630.396 477.231C650.284 444.555 660.555 406.934 660.03 368.685C660.308 340.371 654.808 312.298 643.866 286.181C633.063 261.017 617.514 238.17 598.068 218.888C578.651 199.807 555.799 184.572 530.718 173.987C504.558 163.065 476.449 157.585 448.102 157.88C419.752 157.602 391.642 163.102 365.486 174.044C340.188 184.606 317.281 200.163 298.136 219.785C279.056 239.182 263.821 262.015 253.236 287.079C242.294 313.196 236.794 341.269 237.072 369.583C237.072 389.339 239.766 408.197 245.154 426.101C250.542 444.959 257.726 462.021 267.604 478.129C276.584 494.293 289.156 508.661 302.626 522.131C310.708 530.213 319.688 537.341 329.566 543.627C308.79 552.947 289.196 564.703 271.196 578.649C247.848 596.609 227.194 618.105 210.132 641.453C193.197 665.566 180.166 692.196 171.518 720.364C170.62 722.16 170.62 723.956 170.62 724.854C99.678 653.07 55.676 556.199 55.676 448.551C55.676 232.358 232.582 55.6199 449 55.6199C665.418 55.6199 842.324 232.358 842.324 448.551C842.206 551.819 801.202 650.838 728.278 723.956V723.956Z"
                            />
                        </svg>
                        <span class="ps-1" th:text="${user.getName()}"></span>
                        <span class="pe-1" th:text="${user.getSurname()}"></span>
                    </a>
                </li>
                <li class="align-self-center py-2 mx-3">
                    <a href="/login">
                        <svg width="25" height="25" viewBox="0 0 48 46" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path
                                    d="M3.3 3.28571H29.7V19.3857H33V3.28571C33 2.41429 32.6523 1.57855 32.0335 0.962363C31.4146 0.346172 30.5752 0 29.7 0H3.3C2.42479 0 1.58542 0.346172 0.966547 0.962363C0.347677 1.57855 0 2.41429 0 3.28571V42.7143C0 43.5857 0.347677 44.4214 0.966547 45.0376C1.58542 45.6538 2.42479 46 3.3 46H29.7C30.5752 46 31.4146 45.6538 32.0335 45.0376C32.6523 44.4214 33 43.5857 33 42.7143H3.3V3.28571Z"
                            />
                            <path
                                    d="M38.3521 22.3948C38.0361 22.1258 37.6295 21.9853 37.2137 22.0012C36.798 22.0172 36.4036 22.1885 36.1093 22.4809C35.8151 22.7734 35.6428 23.1654 35.6267 23.5787C35.6106 23.9919 35.7521 24.396 36.0227 24.7101L41.6066 30.1452H17.652C17.2139 30.1452 16.7937 30.3182 16.4839 30.6262C16.1741 30.9341 16 31.3518 16 31.7873C16 32.2228 16.1741 32.6404 16.4839 32.9484C16.7937 33.2563 17.2139 33.4293 17.652 33.4293H41.6066L36.0227 39.1108C35.8498 39.258 35.7093 39.4391 35.6102 39.6428C35.511 39.8466 35.4553 40.0684 35.4465 40.2946C35.4377 40.5207 35.476 40.7462 35.5591 40.9569C35.6421 41.1677 35.7681 41.359 35.9291 41.5191C36.0901 41.6791 36.2827 41.8043 36.4947 41.8869C36.7067 41.9694 36.9335 42.0075 37.1611 41.9988C37.3886 41.99 37.6118 41.9347 37.8168 41.8361C38.0217 41.7375 38.204 41.5979 38.3521 41.426L48 31.9022L38.3521 22.3948Z"
                            />
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <hr class="my-4">
    <div class="row">
        <div class="col-xl-4">
            <div class="card h-100">
                <div class="card-header">
                    Profile Picture
                </div>
                <div class="card-body text-center">
                    <span th:if="${user.getImage() != null}">
                    <img class="rounded-circle mb-2 object-fit-cover"
                         alt="user"
                         width="250"
                         height="250"
                         th:src="*{'data:image/*;base64,'+user_image}"/>
                    </span>
                    <span th:unless="${user.getImage() != null}">
                        <img class="rounded-circle mb-2 object-fit-cover"
                             alt="user"
                             width="250"
                             height="250"
                             src="https://img.icons8.com/dotty/250/user.png"/>
                    </span>
                    <div class="small font-italic text-muted mb-4">
                        JPG or PNG no larger than 5 MB
                    </div>
                    <form th:method="POST" th:action="@{/user/account/photo/add(id=${user.getId()})}"
                          enctype="multipart/form-data">
                        <div class="mb-3 w-75 mx-auto">
                            <input
                                    id="image_input"
                                    class="form-control form-control-sm"
                                    type="file"
                                    name="image"
                                    accept="image/*">
                        </div>
                        <button id="image_submit_btn" class="d-none btn btn-primary" type="submit">
                            Upload new image
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-xl-8">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <button class="nav-link active"
                            id="nav-home-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#nav-home"
                            type="button"
                            role="tab" aria-controls="nav-home" aria-selected="true">
                        Account Details
                    </button>
                    <button class="nav-link"
                            id="nav-profile-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#nav-profile"
                            type="button"
                            role="tab" aria-controls="nav-profile" aria-selected="false">
                        Security
                    </button>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active"
                     id="nav-home"
                     role="tabpanel"
                     aria-labelledby="nav-home-tab"
                     tabindex="0">
                    <div class="card border-top-0 h-100">
                        <div class="card-body">
                            <form th:method="POST" th:action="@{/user/account/{id}(id=${user.getId()})}"
                                  th:object="${user}">
                                <div class="row gx-3 mb-3">
                                    <div class="col-md-6">
                                        <label class="small mb-1" for="inputFirstName">
                                            First name
                                        </label>
                                        <input type="text"
                                               th:field="*{name}"
                                               class="form-control"
                                               id="inputFirstName"
                                               placeholder="Enter your first name">
                                        <div style="color: red"
                                             th:if="${#fields.hasErrors('name')}"
                                             th:errors="*{name}">
                                            Error
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="small mb-1" for="inputLastName">
                                            Last name
                                        </label>
                                        <input type="text"
                                               th:field="*{surname}"
                                               class="form-control"
                                               id="inputLastName"
                                               placeholder="Enter your last name">
                                        <div style="color: red"
                                             th:if="${#fields.hasErrors('surname')}"
                                             th:errors="*{surname}">
                                            Error
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="small mb-1" for="inputEmailAddress">
                                        Email address
                                    </label>
                                    <input type="email"
                                           th:field="*{email}"
                                           class="form-control"
                                           id="inputEmailAddress"
                                           placeholder="Enter your email address">
                                    <div style="color: red"
                                         th:if="${#fields.hasErrors('email')}"
                                         th:errors="*{email}">
                                        Error
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="small mb-1" for="inputPhone">
                                        Phone number
                                    </label>
                                    <input type="tel"
                                           th:field="*{phone}"
                                           class="form-control"
                                           id="inputPhone"
                                           placeholder="Enter your phone number">
                                    <div style="color: red"
                                         th:if="${#fields.hasErrors('phone')}"
                                         th:errors="*{phone}">
                                        Error
                                    </div>
                                </div>
                                <div class="row gx-3 mb-3">
                                    <div class="col-md-6">
                                        <label class="small mb-1" for="totalLoanedBooks">
                                            Number of loaned books
                                        </label>
                                        <input class="form-control"
                                               id="totalLoanedBooks"
                                               type="text"
                                               th:value="${user.getBooks().size()}"
                                               disabled>
                                    </div>
                                    <div class="col-md-6">
                                    </div>
                                </div>
                                <button class="btn btn-primary" type="submit">
                                    Save changes
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade"
                     id="nav-profile"
                     role="tabpanel"
                     aria-labelledby="nav-profile-tab"
                     tabindex="0">
                    <div class="card border-top-0 h-100">
                        <div class="card-body">
                            <form th:method="POST" th:action="@{/user/account/change_password/{id}(id=${user.getId()})}"
                                  th:object="${user}">
                                <div class="row gx-3 mb-3">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="small mb-1" for="inputPassword">
                                                New password
                                            </label>
                                            <input type="password"
                                                   th:field="*{password}"
                                                   class="form-control"
                                                   id="inputPassword"
                                                   placeholder="Enter new password">
                                            <div style="color: red"
                                                 th:if="${#fields.hasErrors('password')}"
                                                 th:errors="*{password}">
                                                Error
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col">
                                        <button class="btn btn-primary" type="submit">
                                            Change password
                                        </button>
                                    </div>
                                    <div class="col text-end">
                                        <a th:href="@{/user/account/delete/{id}(id=${user.getId()})}">
                                            <button class="btn btn-danger" type="button">
                                                Delete account?
                                            </button>
                                        </a>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr class="my-4">
</div>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
    <path fill="#0D6EFD" fill-opacity="1"
          d="M0,192L40,202.7C80,213,160,235,240,245.3C320,256,400,256,480,229.3C560,203,640,149,720,128C800,107,880,117,960,128C1040,139,1120,149,1200,170.7C1280,192,1360,224,1400,240L1440,256L1440,320L1400,320C1360,320,1280,320,1200,320C1120,320,1040,320,960,320C880,320,800,320,720,320C640,320,560,320,480,320C400,320,320,320,240,320C160,320,80,320,40,320L0,320Z"></path>
</svg>
<div class="bg-primary" id="footer">
    <div class="container">
        <footer class="row row-cols-1 row-cols-sm-2 row-cols-md-5 py-5 border-top">
            <div class="col mb-3">
                <a href="/" class="d-flex align-items-center mb-3 link-dark text-decoration-none">
                    <img class="logo_img" src="/img/logo_rmat_2.png" alt="" width="100">
                </a>
                <p class="text-white">Over99 © 2022</p>
            </div>
            <div class="col mb-3">
                <p class="text-white">
                    If you have any questions or suggestions, you can contact us via messengers or by writing to us by
                    mail
                </p>
            </div>
            <div class="col mb-3">
            </div>
            <div class="col mb-3">
                <h5 class="text-white mb-3">Sections</h5>
                <ul class="nav flex-column">
                    <li class="nav-item mb-2">
                        <a href="/#" class="nav-link text-white p-0">
                            Home
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a href="/#why" class="nav-link text-white p-0">
                            Why LibMS
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a href="/#work" class="nav-link text-white  p-0">
                            How It Works
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a href="/login" class="nav-link text-white p-0">
                            Sign In
                        </a>
                    </li>
                </ul>
            </div>

            <div class="col mb-3">
                <h5 class="text-white mb-3">Contacts</h5>
                <ul class="nav flex-column align-self-center">
                    <li class="nav-item text-white mb-2">
                        <div class="row">
                            <div class="col-3">
                                <i class="fas fa-home"></i>
                            </div>
                            <div class="col-9">
                                Astana
                            </div>
                        </div>
                    </li>
                    <li class="nav-item text-white mb-2">
                        <div class="row">
                            <div class="col-3">
                                <i class="fas fa-envelope-open-text"></i>
                            </div>
                            <div class="col-9">
                                libms@gmail.com
                            </div>
                        </div>
                    </li>
                    <li class="nav-item text-white mb-2">
                        <div class="row">
                            <div class="col-3">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="col-9">
                                +7 (708) 517-64-91
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </footer>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
<script src="/src/account.js"></script>
</body>
</html>